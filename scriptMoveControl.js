// –ò—Å—Ç–æ—Ä–∏—è —Ö–æ–¥–æ–≤
let moveHistory = []; // –ú–∞—Å—Å–∏–≤ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–π –ø–æ–ª—è
let redoHistory = []; // –ú–∞—Å—Å–∏–≤ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ—Ç–º–µ–Ω—ë–Ω–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π –ø–æ–ª—è
const MAX_HISTORY_SIZE = 5; // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Ö—Ä–∞–Ω—è–µ–º—ã—Ö —Ö–æ–¥–æ–≤

// –≠–ª–µ–º–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
const undoButton = document.getElementById('undo-move');
const redoButton = document.getElementById('return-move');

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–û—Ç–º–µ–Ω–∏—Ç—å —Ö–æ–¥" (Undo)
undoButton.addEventListener('click', () => {
  if (isAnimating) return; // –ë–ª–æ–∫–∏—Ä—É–µ–º, –µ—Å–ª–∏ –ø–ª–∏—Ç–∫–∏ –µ—â—ë –¥–≤–∏–≥–∞—é—Ç—Å—è
  if (moveHistory.length > 0) {
    // 1. –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ redoHistory –ü–ï–†–ï–î –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ–º
    redoHistory.push(getCurrentState());

    // 2. –î–æ—Å—Ç–∞–µ–º –ø—Ä–æ—à–ª–æ–µ
    const lastState = moveHistory.pop();

    // 3. –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º
    restoreState(lastState);

    // 4. –û–±–Ω–æ–≤–ª—è–µ–º UI —Å—á–µ—Ç—á–∏–∫–∞
    // updateMoveCount(-1);
    // === -üìù=TODO=üìù- === –∏—Å–ø—Ä–∞–≤–∏—Ç—å —Ä–∞–±–æ—Ç—É —Å—á—ë—Ç—á–∏–∫–∞ –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ —Ö–æ–¥–æ–≤
  }
});

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–í–µ—Ä–Ω—É—Ç—å —Ö–æ–¥" (Redo)
redoButton.addEventListener('click', () => {
  if (isAnimating) return; // –ë–ª–æ–∫–∏—Ä—É–µ–º
  if (redoHistory.length > 0) {
    // 1. –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–µ–µ (–∫–æ—Ç–æ—Ä–æ–µ —Å–µ–π—á–∞—Å —Å—Ç–∞–Ω–µ—Ç –ø—Ä–æ—à–ª—ã–º) –≤ moveHistory
    moveHistory.push(getCurrentState());

    // 2. –î–æ—Å—Ç–∞–µ–º –±—É–¥—É—â–µ–µ
    const nextState = redoHistory.pop();

    // 3. –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º
    restoreState(nextState);

    // 4. –û–±–Ω–æ–≤–ª—è–µ–º UI —Å—á–µ—Ç—á–∏–∫–∞
    // updateMoveCount(1);
    // === -üìù=TODO=üìù- === –∏—Å–ø—Ä–∞–≤–∏—Ç—å —Ä–∞–±–æ—Ç—É —Å—á—ë—Ç—á–∏–∫–∞ –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ —Ö–æ–¥–æ–≤
  }
});

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ –∏—Å—Ç–æ—Ä–∏—é
function addMoveToHistory(state) {
  if (moveHistory.length >= MAX_HISTORY_SIZE) {
    moveHistory.shift(); // –£–¥–∞–ª—è–µ–º —Å–∞–º–æ–µ —Å—Ç–∞—Ä–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –µ—Å–ª–∏ –∏—Å—Ç–æ—Ä–∏—è –ø—Ä–µ–≤—ã—à–∞–µ—Ç –ª–∏–º–∏—Ç
  }
  moveHistory.push(state); // –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ –∏—Å—Ç–æ—Ä–∏—é
  redoHistory = []; // –û—á–∏—â–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é –≤–æ–∑–≤—Ä–∞—Ç–∞, —Ç–∞–∫ –∫–∞–∫ –Ω–æ–≤—ã–π —Ö–æ–¥ –¥–µ–ª–∞–µ—Ç –µ—ë –Ω–µ–∞–∫—Ç—É–∞–ª—å–Ω–æ–π
}